10     'SAVE "NEWV3-3.BAS":END
20 '¼®· ¾¯Ã²WWWWWWWWWWWWWWWWWWWWWWWWWWW
30 CLEAR80,&HCB00:DEFINT A-Z:OPEN"GRP:"AS#1:COLOR 15,1,1:KEY OFF:SCREEN 0,2,0:WIDTH40:PRINT"NEW CHARACTER EDITOR MSX V3.3A":PRINT"(C)1991/1992/2022 m@3"
40 LOCATE0,2:PRINT "1-8*8 2-16*16 3-32*32 EDIT - SELECT! ";:X=VAL(INPUT$(1)):IFX<1ORX>3THEN40ELSEIFX=3THENSI=16:SW=32:SZ=4ELSESI=X*8:SW=SI:SZ=8
50 PRINTA$:PRINTUSING"(##x## EDITOR MODE)";SI;SI;:ONERRORGOTO80:_TURBOON
60 PRINT" : TURBO-MODE ON":_TURBOOFF
70 TB=1:GOTO90
80 TB=0:RESUME90
90 ONERRORGOTO770:SCREEN 5,2,0:VDP(9)=VDP(9) OR 32  :DEFUSR1=&H69:DEFUSR=342:COLOR=(15,0,0,0):COLOR=(0,0,4,3)
100 ON STOP GOSUB 750:STOP ON:ON KEY GOSUB 330,350,380,420,450,480,500,530,730,560
110 '½Ìß×²ÄÉÃÞ-À¦ Â¸ÙWWWWWWWWWWWWWWWWWW
120 FOR J=0 TO 3:READ B$:SPRITE$(J)="":FOR I=0 TO 31:A$=A$+CHR$(VAL("&H"+MID$(B$,I*2+1,2))):NEXT:SPRITE$(J)=A$:A$="":NEXT:IFSW=32THENSPRITE$(0)=SPRITE$(3)
130 '½Ìß×²Ä É ÃÞ-ÀWWWWWWWWWWWWWWWWWWWWW
140 DATA FF80808080808080FF00000000000000808080808080808080,FF8080808080808080808080808080FFFF0101010101010101010101010101FF,3C3C3C3CFF7E3C18,F8888888F8
150 '¶ÞÒÝ Ê²ÁWWWWWWWWWWWWWWWWWWWWWWWWWW
160 FOR I=0 TO SW:LINE (I*SZ,8)-(I*SZ,8+SI*8),15:LINE (0,I*SZ+8)-(SI*8,I*SZ+8),15:NEXT I:COLOR=(15,7,7,7):FOR I=0 TO 15:LINE (I*8,190)-STEP(7,7),I,BF:NEXT I
170 S=43:X=0:Y=8:A=0:B=0:XM=136:YM=8:PG=0:PUT SPRITE 0,(X,Y-1),5,0:M=120:PUT SPRITE 1,(M,181),15,2:LINE (136,S-2)-(255,140-1),7,B
180 READA$:IF A$<>"N" THEN PRESET (138,S):PRINT #1,A$:S=S+8:GOTO 180
190 PRESET (192,8):PRINT #1,"( 0  0)":GOSUB 230
200 DATA ÃÝ·-=²Û¶´,F1=ÇØÂÌÞ¼,F2=²Á¼ÞÎ¿ÞÝ,F3=Î¿ÞÝÖËÞÀÞ¼,F4=¾-ÌÞ,F5=Û-ÄÞ,F6=»Õ³ÊÝÃÝ,F7=¼Þ®³¹ÞÊÝÃÝ,F8=²Ú¶´,F9=»²½ÞÍÝº³,F10=Ï¯Ìß´ÃÞ¨À-
210 DATA RET=·¬Ý¾Ù,N
220 '·-¸Ø±WWWWWWWWWWWWWWWWWWWWWWWWWWWWW
230 SETPAGE ,0:FOR I=1 TO 10:KEY (I) OFF:NEXT:FOR I=1 TO 10:KEY (I) ON:KEY I,"":NEXT:U=USR(0):LINE (8,140)-(255,171),1,BF:SETPAGE 0:PUT SPRITE 0,(X,Y-1),5,0:PUT SPRITE 1,(M,181),15,2:A$="":B$="":C$="":RETURN 250
240 'Ò²ÝÙ-ÌßWWWWWWWWWWWWWWWWWWWWWWWWWWW
250 S=STICK(0) OR STICK(1):AA=PEEK(&HFBEB):IFS=0GOTO 280ELSEX=X-(S<5 AND S>1 AND X<SW*SZ-SZ)*SZ+(S>5 AND X>0)*SZ:Y=Y-(S>3 AND S<7 AND Y-8<SW*SZ-SZ)*SZ+((S=1 OR S=2 OR S=8)AND Y>8)*SZ:PUTSPRITE 0,(X,Y-1),5,0
260 IF(AAAND4)=0THENPRESET (192,8):PRINT #1,USING"(## ##)";X\SZ;(Y-8)\SZ
270 '²ÛÇØWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
280 IF STRIG(0) OR STRIG(1) THEN LINE (X+1,Y+1)-(X+SZ-1,Y+SZ-1),M\8,BF:PSET (X\SZ+XM,(Y-8)\SZ+YM),M\8ELSEIF(AAAND3)=0THENGOSUB582
290 '²Û¶´WWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
300 AA=PEEK(&HFBE7):S=((PEEK(&HFBEE) AND 128)=0 OR (AA AND 4)=0)+((PEEK(&HFBEF) AND 2)=0 OR (AA AND 8)=0)*2:IF S<>0 THEN FOR I=1 TO 1:M=M-(S=-2 AND M<120)*8+(S=-1 AND M>0)*8:PUT SPRITE 1,(M,181),M\8-(M<16)*14,2:NEXT I
310 GOTO 250
320 'ÇØÂÌÞ¼WWWWWWWWWWWWWWWWWWWWWWWWWWWW
330 A$="<BOX>":GOSUB690:LINE (0,8)-(SI*8,8+SI*8),M\8,BF:FOR I=0 TO SW:LINE (I*SZ,8)-(I*SZ,8+SI*8),15:LINE (0,I*SZ+8)-(SI*8,I*SZ+8),15:NEXT I:LINE (XM,YM)-(XM+SW-1,YM+SW-1),M\8,BF:GOTO 230
340 'Ä³Û¸WWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
350 A$="<PUT>":GOSUB690:GOSUB610
360 IFPEEK(&HFBEB)AND4THENCOPY(XM,YM)-(XM+SW-1,YM+SW-1),0TO(A,B),PG+1,PSET:GOSUB630:GOTO360ELSECOPY(XM,YM)-(XM+SW-1,YM+SW-1),0TO(A,B),PG+1,TPSET:GOSUB630:GOTO360
370 'ÖËÞÀÞ¼WWWWWWWWWWWWWWWWWWWWWWWWWWWW
380 A$="<GET>":GOSUB 690:GOSUB610:SETPAGE 0,0:DRAW"BM8,156":PRINT#1,"¼Þ¯º³Á­³":IFTBTHEN_TURBOON(A,B,PG,XM,YM,SW,SI,SZ,TB)
390 COPY (A,B)-(A+SW-1,B+SW-1),PG+1 TO (XM,YM),0:FOR J=0 TO SW-1:FOR I=0 TO SW-1:LINE (I*SZ+1,J*SZ+1+8)-STEP(SZ-2,SZ-2),POINT (XM+I,YM+J),BF:NEXT I,J:IFTBTHEN_ TURBO OFF
400 GOTO 230
410 '¾-ÌÞWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
420 A$="<SAVE>":GOSUB690:KK$="SC5":GOSUB 820:SETPAGE PG+1,PG+1
430 U=USR1(0):BSAVE N$+".SC5",0,&H69FF,S:GOTO 230
440 'Û-ÄÞWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
450 A$="<LOAD>":GOSUB690:SETPAGE0,0:KK$="SC5":GOSUB 820:SET PAGE PG+1,PG+1:BLOAD N$+".SC5",S
460 GOTO 230
470 'ÊÝÃÝWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
480 A$="<R-L TURN>   ":GOSUB690:PRINT#1," ¼Þ¯º³Á­³":DIM B(8457\2+1):COPY (0,8)-(SI*8,64+7),0 TO B:COPYB,1TO(SI*8,8),0
490 COPY(0,64+8)-(SI*8,136),0TOB:COPY B,1 TO (SI*8,64+8),0:COPY (XM,YM)-(XM+SW-1,YM+SW-1),0 TO B:COPY B,1 TO (XM+SW-1,YM),0:ERASEB:GOTO230
500 A$="<U-D TURN>":GOSUB690:PRINT#1," ¼Þ¯º³Á­³":DIM B(8457\2+1):COPY (0,8)-(64-1,8+SI*8),0 TO B:COPYB,2TO(0,8+SI*8),0
510 COPY(64,8)-(128,8+SI*8),0TOB:COPY B,2 TO (64,8+SI*8),0:COPY (XM,YM)-(XM+SW-1,YM+SW-1),0 TO B:COPY B,2 TO (XM,YM+SW-1),0:ERASE B:GOTO230
520 '²Ú¶´WWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
530 A$="<CHANGE>":GOSUB690:GOSUB610
540 BEEP:AA=A:BB=B:PZ=PG:FORI=-1TO0:I=STRIG(0):NEXTI:GOSUB630:BEEP:A=A:B=B:DIMA(400):COPY(AA,BB)-(AA+SW-1,BB+SW-1),PZ+1TOA:COPY(A,B)-(A+SW-1,B+SW-1),PG+1TO(AA,BB),PZ+1:COPYATO(A,B),PG+1:ERASEA:GOSUB630:GOTO540
550 '±ÆÒ°¼®ÝWWWWWWWWWWWWWWWWWWWWWWWWWWW
560 '
570 GOSUB780:RUN"MEDIT411.BAS":RETURN
580 'ÊßÚ¯Ä ¾¯Ã²WWWWWWWWWWWWWÊ¤Å¸Å¯À¥¥¥W
581 '-------------
582 A$="<REMOVE>":B$="CURSOR=MOVE/RET=END":GOSUB 690:DIMB(520):COPY(XM,YM)-STEP(SW-1,SW-1)TOB
583 S=STICK(0)ORSTICK(1):IFSTHENCX=(S<5ANDS>1)-(S>5):CY=(S>3ANDS<7)-(S=1ORS=2ORS=8):DIMA(520):COPY(XM+CX,YM+CY)-(XM+SW-1+CX,YM+SW-1+CY)TOA:COPYATO(XM,YM),,PSET:ERASEA:GOTO583
584 A$=INKEY$:IFA$=CHR$(27)THENCOPYBTO(XM,YM):ERASEB:GOTO230
585 IFS=0ANDA$<>CHR$(13)THEN583
587 ERASEB:DRAW"BM8,156":PRINT#1,"¼Þ¯º³Á­³":IFTBTHEN_TURBOON(XM,YM,SW,SZ,TB)
588 FOR J=0 TO SW-1:FOR I=0 TO SW-1:LINE (I*SZ+1,J*SZ+1+8)-STEP(SZ-2,SZ-2),POINT (XM+I,YM+J),BF:NEXT I,J:IFTBTHEN_ TURBO OFF
589 GOTO 230
590 '·-Æ­³Ø®¸WWWWWWWWWWWWWWWWWWWWWWWWWW
600 U=USR(0):FOR A=0 TO 1:A$=INKEY$:A=VAL("&H"+A$)-(A$=CHR$(13))*16:NEXT:A=A-1:IF A=16 THEN RETURN 230 ELSE RETURN
610 U=USR(0):PRINT #1," HIT ANY KEY!":A$=INPUT$(1):IF A$=CHR$(13) THEN RETURN 230 ELSE U=USR(0):GOSUB 800:IFSW=8THENA$=SPRITE$(0)ELSEA$=CHR$(255)+STRING$(14,&H80)+CHR$(255)+CHR$(255)+STRING$(14,&H1)+CHR$(255)
620 FOR U=1 TO 3:SETPAGE ,U:SPRITE$(USR1(0))=A$:NEXT U
630 IFSW=32THENVDP(1)=VDP(1)XOR1
640 FOR I=0 TO 1:SETPAGE PG+1,PG+1:S=STICK(0)ORSTICK(1):IF(PEEK(&HFBEB)AND4)THENSO=SWELSESO=8
650 B=B+(((S=1ORS=2ORS=8)ANDB>0)-(S>3ANDS<7ANDB<211-SW))*SO:A=A+((S>5ANDA>0)-(S<5ANDS>1ANDA<256-SW))*SO
660 PUTSPRITE0,(A,B-1),RND(1)*14+2,0:A$=INKEY$:I=-(STRIG(0)ORSTRIG(1))-(A$=CHR$(13)ORSTRIG(3))*2
670 PG=(PG-(A$=CHR$(24)))MOD3:NEXTI:IFSW=32THENVDP(1)=VDP(1)XOR1
680 COLOR=(4,7,7,7):COLOR=(4,0,0,7):IF I=3 THEN RETURN 230 ELSE BEEP:RETURN
690 FORI=1TO10:KEY(I)OFF:NEXT:SETPAGE0,0:COLOR3:DRAW"BM8,140":PRINT#1,A$:A$="":COLOR15:IFB$<>""THENPRINT#1,SPC(1);B$:B$="":IFC$<>""THENPRINT#1,SPC(1);C$:C$=""
700 'U=USR(0):PRINT #1," (HIT ANY KEY!)":A$=INPUT$(1):IF A$=CHR$(13) THEN RETURN 190 ELSE U=USR(0):RETURN
710 U=USR(0):RETURN
720 'Ê¼ÞÒÆÓÄÞÙWWWWWWWWWWWWWWWWWWWWWWWWW
730 RETURN30:GOSUB780:RUN "MEDIT2-1.BAS"
740 'µÜØWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW
750 BEEP:STOP OFF:COLOR 15,0,0:GOSUB780:ON ERROR GOTO 0:END
760 '´×-¼®ØWWWWWWWWWWWWWWWWWWWWWWWWWWWW
770 SET PAGE 0,0:IF ERR>50 THEN LINE (8,140)-(255,163),1,BF:DRAW "BM8,140":PRINT#1,USING "´×-ÃÞ½Ö-ÝÀÞ¡NO=##";ERR:FOR I=0 TO 5000:NEXT:RESUME 230 ELSE 750
780 BEEP:DEFUSR=&H3E:U=USR(0):KEY7,"files"+CHR$(13):KEY10,"load"+CHR$(34)+CHR$(13):KEY8,"run"+CHR$(34)+"newv3.bas"+CHR$(13):DEFUSR=342:U=USR(0):RETURN
790 'SPRITE SYOKIKAWWWWWWWWWWWWWWWWWWWW
800 FOR I=0 TO 31:PUT SPRITE I,(0,217):NEXT I:RETURN
810 'WORD PUTWWWWWWWWWWWWWWWWWWWWWWWWW
820 DRAW "BM8,148":PRINT #1,"INPUT NAME(8 WORDS)":DRAW "BM8,156":COLOR 8:PRINT #1,"________";:COLOR 15:PRINT #1,"."KK$:PRINT#1," (PAGE";PG+1;")":N$="":DRAW "BM8,156":FOR I=1 TO 8
830 S=ASC(INPUT$(1)):IF S=13 THEN IF I=1 THEN COLOR 15:RETURN 230 ELSE I=-(I<>1)*8:GOTO 850
840 IF S=8 AND I<>1 THEN I=I-2:PSET (8+I*8,156),1:COLOR 8:PRINT #1,"_":PRESET (8+I*8,156),1:N$=LEFT$(N$,I): ELSE IF S<48 OR (S<65ANDS>57) OR A=127 THEN I=I-1 ELSE COLOR 15:N$=N$+CHR$(S):PRINT #1,CHR$(S);
850 NEXT I:COLOR 15:FOR I=0 TO 500:NEXT I
860 SETPAGE PG+1,PG+USR(1):A$=INPUT$(1):IFA$=CHR$(27)THENRETURN230ELSEIFA$=CHR$(24)THENPG=(PG+1)MOD3:GOTO 860ELSERETURN
870 KK$="GRP":GOSUB820:SETPAGE,1:LINE(160,0)-(191,31),1,BF:GOTO 890:ON SM GOTO 880,890
880 COPY(0,0)-(224,128)TON$+".GRP":GOTO 230
890 COPYN$+".GRP"TO(160,0),,PSET:GOTO 230
